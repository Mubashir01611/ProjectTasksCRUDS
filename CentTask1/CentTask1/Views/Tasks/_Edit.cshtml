@model CentTask1.ViewModels.TaskViewModels.TaskDetailViewModel;
<style>
    .col-md-6 {
        margin-bottom: 15px;
    }
</style>
<form asp-action="Edit" asp-controller="Tasks" method="post" id="editProjectTaskForm">

    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <input type="hidden" asp-for="Id" />

    <div class="row">
        <div class="col-md-6">
            <label asp-for="TaskName" class="control-label text-start float-start"></label>
            <span class="text-danger float-start"> *</span>
            <input asp-for="TaskName" class="form-control" />
            <span asp-validation-for="TaskName" class="text-danger"></span>
            <br />

            <label asp-for="Description" class="control-label text-start float-start"></label>
            <input asp-for="Description" class="form-control" />
            <br />

            <label asp-for="StartDate" class="control-label float-start text-start"></label>
            <span class="text-danger float-start"> *</span>
            <input type="date" asp-for="StartDate" class=" form-control" />
            <span asp-validation-for="StartDate" class="text-danger"></span>
            <br />

            <label asp-for="TWR" class="control-label text-start float-start "></label>
            <input asp-for="TWR" class="form-control mb-5" />
            <span asp-validation-for="TWR" class="text-danger"></span>


        </div>
        <div class="col-md-6">

            <label asp-for="Priority" class="control-label text-start float-start"></label>
            <input asp-for="Priority" class="form-control" />
            <br />

            <label asp-for="EquipmentType" class="control-label text-start float-start"></label>
            <input asp-for="EquipmentType" class="form-control" />
            <br />

            <label asp-for="EndDate" class="control-label float-start text-start"></label>
            <span class="text-danger float-start"> *</span>
            <input type="date" asp-for="EndDate" class="form-control" />
            <span asp-validation-for="EndDate" class="text-danger"></span>

            <br />

            <label asp-for="ProjectId" class="form-label">Project</label>
            <select asp-for="ProjectId" class="form-select js-select2" id="projectSelect">
                <option value="">Select a project</option>
                @if (Model.ProjectId != null)
                {
                    var selectedText = Model.ProjectName ?? "Selected Project";
                    <option value="@Model.ProjectId" selected>@selectedText</option>
                }
            </select>
            <span asp-validation-for="ProjectId" class="text-danger"></span>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <a class="btn btn-danger" data-bs-dismiss="modal">Cancel</a>

        </div>
        <div class="col-md-6">
            <input type="submit" value="Save" name="submit" id="submitProjectTaskEditForm" data-url="/Tasks/Edit" class="btn btn-primary mr-2" />

        </div>
    </div>

</form>

<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        // This script will initialize Select2 if the partial is loaded directly.
        // When the partial is injected into the modal via AJAX the parent script also initializes,
        // but keeping this ensures it works when the partial is used standalone.
        (function () {
            if (typeof $ === 'undefined' || !$('#projectSelect').length) return;

            $('#projectSelect').select2({
                theme: 'bootstrap5', // adjust to bootstrap4 if you're using bootstrap4
                placeholder: 'Search and select a project',
                allowClear: true,
                dropdownParent: $('#createOrEditProjectTask'),
                ajax: {
                    url: '/Tasks/GetProjectsForDropdown',
                    dataType: 'json',
                    delay: 250,
                    data: function (params) {
                        return { term: params.term };
                    },
                    processResults: function (data) {
                        return { results: data.results };
                    }
                }
            });
        })();
    </script>
}